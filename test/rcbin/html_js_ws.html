<!DOCTYPE html>
<html>
<head>
  <title>Real-time Sensor Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>canvas { max-width: 700px; }</style>
</head>
<body>
  <h2>Real-time DHT11 Data</h2>
  <canvas id="myChart"></canvas>

  <script>
    const ctx = document.getElementById('myChart').getContext('2d');
    const labels = [];
    const tempData = [];
    const humidData = [];

    const chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [
          { label: 'Temp (°C)', data: tempData, borderColor: 'red', yAxisID: 'y' },
          { label: 'Humid (%)', data: humidData, borderColor: 'blue', yAxisID: 'y1' }
        ]
      },
      options: {
        scales: {
          y: { min: 0, max: 50, position: 'left', title: { display: true, text: 'Temp (°C)' } },
          y1: { min: 20, max: 90, position: 'right', title: { display: true, text: 'Humid (%)' }, grid: { drawOnChartArea: false } }
        }
      }
    });

    const ws = new WebSocket('ws://<YOUR_PI_IP>:6789');
    ws.onmessage = event => {
      const data = JSON.parse(event.data);
      const now = new Date().toLocaleTimeString();
      labels.push(now);
      tempData.push(data.temp);
      humidData.push(data.humid);
      if (labels.length > 20) { labels.shift(); tempData.shift(); humidData.shift(); }
      chart.update();
    };
  </script>
</body>
</html>
